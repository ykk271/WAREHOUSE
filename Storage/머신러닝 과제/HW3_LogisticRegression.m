%김예광

clc;
clear;
close all;


%%%%%%% 합격 확률 계산%%%%%%%
%점수를 입력하세요
exam1 = 20;
exam2 = 100;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%% RAW DATA &&&&&&&&&&&&&&

data = [;
    55.5  69.5  1;
    41.0  81.5  1;
    53.5  86.0  1;
    46.0  84.0  1;
    41.0  73.5  1;
    51.5  69.0  1;
    51.0  62.5  1;
    42.0  75.0  1;
    53.5  83.0  1;
    57.5  71.0  1;
    42.5  72.5  1;
    41.0  80.0  1;
    46.0  82.0  1;
    46.0  60.5  1;
    49.5  76.0  1;
    41.0  76.0  1;
    48.5  72.5  1;
    51.5  82.5  1;
    44.5  70.5  1;
    44.0  66.0  1;
    33.0  76.5  1;
    33.5  78.5  1;
    31.5  72.0  1;
    33.0  81.5  1;
    42.0  59.5  1;
    30.0  64.0  1;
    61.0  45.0  1;
    49.0  79.0  1;
    26.5  64.5  1;
    34.0  71.5  1;
    42.0  83.5  1;
    29.5  74.5  1;
    39.5  70.0  1;
    51.5  66.0  1;
    41.5  71.5  1;
    42.5  79.5  1;
    35.0  59.5  1;
    38.5  73.5  1;
    32.0  81.5  1;
    46.0  60.5  1;
    36.5  53.0  0;
    36.5  53.5  0;
    24.0  60.5  0;
    19.0  57.5  0;
    34.5  60.0  0;
    37.5  64.5  0;
    35.5  51.0  0;
    37.0  50.0  0;
    21.5  42.0  0;
    35.5  58.5  0;
    26.5  68.5  0;
    26.5  55.5  0;
    18.5  67.0  0;
    40.0  67.0  0;
    32.5  71.5  0;
    39.0  71.5  0;
    43.0  55.5  0;
    22.0  54.0  0;
    36.0  62.5  0;
    31.0  55.5  0;
    38.5  76.0  0;
    40.0  75.0  0;
    37.5  63.0  0;
    24.5  58.0  0;
    30.0  67.0  0;
    33.0  56.0  0;
    56.5  61.0  0;
    41.0  57.0  0;
    49.5  63.0  0;
    34.5  72.5  0;
    32.5  69.0  0;
    36.0  73.0  0;
    27.0  53.5  0;
    41.0  63.5  0;
    29.5  52.5  0;
    20.0  65.5  0;
    38.0  65.0  0;
    18.5  74.5  0;
    16.0  72.5  0;
    33.5  68.0  0;
    ];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
x1 = data(:,1);
x2 = data(:,2);
y = data(:,3);
m = length(y);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
theta = zeros(3,1);           %theta 초기값
ITR = 1000000;                %임의의 iterations값 설정
alpha = 10^(-5);              %임의의 alpha값 설정
J = NaN(ITR,1);               %J값 사전할당


for i = 1:ITR
z = theta(1) + theta(2).*x1 + theta(3).*x2 ; 
h = 1./(1+exp(-z));

J(i,1) = (1/m)*sum(-y.*log(h) - (1-y).*log(1 - h));


theta(1) = theta(1) - alpha *  sum( (h - y) );
theta(2) = theta(2) - alpha *  sum( (h - y).*x1 );
theta(3) = theta(3) - alpha *  sum( (h - y).*x2 );

end

figure;
plot(J);
J_last = sprintf('마지막 J = %s',J(end));
title({J_last});
legend('J');


prob = 1/( 1 + exp( (-1) * (theta(1) + theta(2)*exam1 + theta(3)*exam2) ) );
prob = prob * 100;
disp_prob = sprintf('합격할 확률은 %.1f퍼센트 입니다.', prob);

disp(disp_prob);
theta
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
index_true  = find(y==1);
index_false = find(y==0);

figure;
plot(x1(index_true),x2(index_true),'+'); hold on
plot(x1(index_false),x2(index_false),'o')

xlim([1 100]);
ylim([1 100]);
xlabel('Exam 1 score');
ylabel('Exam 2 score');

plot_x1 = 1:1:100;
plot_x2 = (-1./theta(3)).*(theta(2).*plot_x1 + theta(1)); % w1 + w2x1 + w3x2 = 0; 
plot(plot_x1,plot_x2);

legend('합격자','불합격','경계선');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




